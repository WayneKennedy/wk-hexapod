# Hexapod Hardware Configuration
# Based on Freenove Big Hexapod Robot Kit (FNK0052)

# Use wildcard to apply to all nodes
/**:
  ros__parameters:
    # I2C Configuration
    i2c:
      bus: 1
      pca9685_addr_1: 0x40  # First servo driver
      pca9685_addr_2: 0x41  # Second servo driver
      mpu6050_addr: 0x68    # IMU
      ads7830_addr: 0x48    # ADC for battery

    # Servo Configuration
    servos:
      pwm_frequency: 50     # Hz
      min_pulse_us: 500
      max_pulse_us: 2500
      power_gpio: 4         # GPIO pin for servo power enable (low=enabled)
      # Leg mapping: [coxa, femur, tibia] servo channels per leg
      # From fn-hexapod control.py - note legs 3,4 have non-contiguous tibia channels
      # Channel routing: 0-15 -> PCA9685 @ 0x41, 16-31 -> PCA9685 @ 0x40
      leg_1: [15, 14, 13]  # RF
      leg_2: [12, 11, 10]  # RM
      leg_3: [9, 8, 31]    # RR - tibia on ch 31!
      leg_4: [22, 23, 27]  # LR - tibia on ch 27!
      leg_5: [19, 20, 21]  # LM
      leg_6: [16, 17, 18]  # LF
      # Head/camera servo channels (from fn-hexapod server.py CMD_CAMERA handler)
      head_channels:
        pan: 0    # Channel 0 on PCA9685 @ 0x41
        tilt: 1   # Channel 1 on PCA9685 @ 0x41
      # Link lengths in mm (for IK)
      link_lengths:
        coxa: 33
        femur: 90
        tibia: 110

    # IMU Configuration
    imu:
      publish_rate: 100.0   # Hz
      accel_range: 2        # +/- 2g
      gyro_range: 250       # +/- 250 deg/s

    # Battery Configuration
    # Physical switches: LOAD (servos) and CTRL (Pi)
    battery:
      publish_rate: 1.0     # Hz
      low_voltage_warn: 6.5 # V per cell (18650 nominal is 3.7V, warn at ~3.25V)
      load_channel: 0       # LOAD battery (servos) - ADC channel 0
      ctrl_channel: 4       # CTRL battery (Pi) - ADC channel 4

    # LED Configuration
    leds:
      count: 7
      brightness: 127       # 50% brightness
      type: 'GRB'           # Color order for WS2812

    # Range Finder Configuration (HC-SR04 ultrasonic)
    range_finder:
      publish_rate: 10.0    # Hz
      trigger_pin: 27       # GPIO pin
      echo_pin: 22          # GPIO pin
      max_range: 3.0        # meters
      min_range: 0.02       # meters (2cm)
      field_of_view: 0.2617 # radians (~15 degrees)

    # Buzzer Configuration
    buzzer:
      gpio_pin: 17                # GPIO pin for buzzer
      default_beep_duration: 0.2  # seconds for single beep

    # Power Indicator Configuration
    # Maps battery voltages to LED colors:
    #   LOAD battery -> Left LEDs (L1, L2, L3)
    #   CTRL battery -> Right LEDs (R1, R2, R3)
    power_indicator:
      update_interval: 10.0       # seconds between LED updates
      voltage_usb: 0.5            # < this: blue (USB/no battery)
      voltage_good: 7.0           # >= this: green
      voltage_warn: 6.5           # >= this: yellow, below: red

    # Startup Sequence Configuration
    # Safe servo initialization with visual/audio warning
    startup:
      auto_start: true        # Auto-run sequence on boot
      warning_duration: 2.0   # seconds of warning before servo snap
      beep_interval: 0.5      # seconds between warning beeps
      place_delay: 10.0       # seconds to place robot on floor after home

    # PCB/Hardware Version
    pcb_version: 2          # V2.0 connector (SPI for LEDs)
    pi_version: 2           # Raspberry Pi 5
